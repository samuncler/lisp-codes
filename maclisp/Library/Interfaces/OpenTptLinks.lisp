(in-package :TRAPS)             ; ;  	File:		OpenTptLinks.p;  ;  	Contains:	Definitions for link modules;  ;  	Copyright:	© 1984-1995 by Apple Computer, Inc.;  				All rights reserved.;  ; ; $IFC UNDEFINED UsingIncludes; $SETC UsingIncludes := 0; $ENDC; $IFC NOT UsingIncludes; $ENDC; $IFC UNDEFINED __OPENTPTLINKS__; $SETC __OPENTPTLINKS__ := 1; $I+; $SETC OpenTptLinksIncludes := UsingIncludes; $SETC UsingIncludes := 1; $IFC UNDEFINED __OPENTRANSPORT__; $I OpenTransport.p; $ENDC; 	Types.p														; 		ConditionalMacros.p										; 	MixedMode.p													; 	Strings.p													; $PUSH; $ALIGN MAC68K; $LibExport+; $SETC kPortBaseResID := 1000(defconstant $kOTADEVDevice 1)  ;  An Atalk ADEV		(defconstant $kOTMDEVDevice 2)  ;  A TCP/IP MDEV		(defconstant $kOTLocalTalkDevice 3);  LocalTalk			(defconstant $kOTIRTalkDevice 4);  IRTalk				(defconstant $kOTTokenRingDevice 5);  Token Ring			(defconstant $kOTISDNDevice 6)  ;  ISDN					(defconstant $kOTATMDevice 7)   ;  ATM					(defconstant $kOTSMDSDevice 8)  ;  SMDS					(defconstant $kOTSerialDevice 9);  Serial 				(defconstant $kOTEthernetDevice 10);  Ethernet				(defconstant $kOTSLIPDevice 11) ;  SLIP Pseudo-device	(defconstant $kOTPPPDevice 12)  ;  PPP Pseudo-device	(defconstant $kOTModemDevice 13);  Modem Pseudo-Device	(defconstant $kOTFastEthernetDevice 14);  100 MB Ethernet		(defconstant $kOTFDDIDevice 15) ;  FDDI					(defconstant $kOTATMLANEDevice 16);  ATM LAN emulation	(defconstant $kOTATMSNAPDevice 17);  ATM SNAP emulation	; ******************************************************************************; ** Interface option flags; *******************************************************************************; ;  Ethernet framing options; (defconstant $kOTFramingEthernet #X1)(defconstant $kOTFramingEthernetIPX #X2)(defconstant $kOTFraming8023 #X4)(defconstant $kOTFraming8022 #X8); ;  Raw mode options; (defconstant $kOTRawRcvOn 0)(defconstant $kOTRawRcvOff 1)(defconstant $kOTRawRcvOnWithTimeStamp 2); ;  OPT_SETPROMISCUOUS value; (defconstant $DL_PROMISC_OFF 0); ******************************************************************************; ** Module definitions; *******************************************************************************; ;  XTI Levels; (defconstant $LNK_ENET :|ENET|)(defconstant $LNK_TOKN :|TOKN|)(defconstant $LNK_FDDI :|FDDI|)(defconstant $LNK_TPI :|LTPI|); ;  Module IDs; (defconstant $kT8022ModuleID 7100)(defconstant $kEnetModuleID 7101)(defconstant $kTokenRingModuleID 7102)(defconstant $kFDDIModuleID 7103); ;  Module Names; (defconstant $kEnet8022Name "enet8022x")(defconstant $kEnetName :|enet|)(defconstant $kFastEnetName "fenet")(defconstant $kTokenRingName :|tokn|)(defconstant $kFDDIName :|fddi|)(defconstant $kIRTalkName "irtlk")(defconstant $kSMDSName :|smds|)(defconstant $kATMName "atm")(defconstant $kT8022Name "tpi8022x")(defconstant $kATMLANEName "atmlane")(defconstant $kATMSNAPName "atmsnap"); ;  Address Family; (defconstant $AF_8022 8200)     ;  Our 802.2 generic address family	; ******************************************************************************; ** Options; *******************************************************************************(defconstant $OPT_ADDMCAST #X1000)(defconstant $OPT_DELMCAST #X1001)(defconstant $OPT_RCVPACKETTYPE #X1002)(defconstant $OPT_RCVDESTADDR #X1003)(defconstant $OPT_SETRAWMODE #X1004)(defconstant $OPT_SETPROMISCUOUS #X1005)(defconstant $kETypeStandard 0)(defconstant $kETypeMulticast 1)(defconstant $kETypeBroadcast 2)(defconstant $kETRawPacketBit #X80000000)(defconstant $kETTimeStampBit #X40000000); ******************************************************************************; ** Link related constants; *******************************************************************************(defconstant $kMulticastLength 6);  length of ENET hardware addresses	(defconstant $k48BitAddrLength 6)(defconstant $k8022DLSAPLength 2);  The protocol type is our DLSAP		(defconstant $k8022SNAPLength 5)(defconstant $kEnetAddressLength (+ #$K48BITADDRLENGTH #$K8022DLSAPLENGTH))(defconstant $kSNAPSAP #XAA)    ;  Some special DLSAPS for ENET		(defconstant $kIPXSAP #XFF)(defconstant $kMax8022SAP #XFE)(defconstant $k8022GlobalSAP #XFF)(defconstant $kMinDIXSAP 1501)(defconstant $kMaxDIXSAP #XFFFF); ******************************************************************************; ** Generic Address Structure; *******************************************************************************(defrecord T8022Address    (fAddrFamily :OTADDRESSTYPE)   (fHWAddr (:ARRAY :SINT8 (- (- #$K48BITADDRLENGTH 1) 0 -1)));  UInt8    (fSAP :UINT16)   (fSNAP (:ARRAY :SINT8 (- (- #$K8022SNAPLENGTH 1) 0 -1)));  UInt8    )(defconstant $k8022BasicAddressLength (+ (RECORD-LENGTH OTADDRESSTYPE) (+ #$K48BITADDRLENGTH (RECORD-LENGTH UINT16))))(defconstant $k8022SNAPAddressLength (+ (RECORD-LENGTH OTADDRESSTYPE) (+ #$K48BITADDRLENGTH (+ (RECORD-LENGTH UINT16) #$K8022SNAPLENGTH)))); ******************************************************************************; ** Some helpful stuff for dealing with 48 bit addresses; *******************************************************************************; $ALIGN RESET; $POP; $SETC UsingIncludes := OpenTptLinksIncludes; $ENDC                         ; __OPENTPTLINKS__; $IFC NOT UsingIncludes; $ENDC(export '($K8022SNAPADDRESSLENGTH $K8022BASICADDRESSLENGTH $KMAXDIXSAP          $KMINDIXSAP $K8022GLOBALSAP $KMAX8022SAP $KIPXSAP $KSNAPSAP          $KENETADDRESSLENGTH $K8022SNAPLENGTH $K8022DLSAPLENGTH          $K48BITADDRLENGTH $KMULTICASTLENGTH $KETTIMESTAMPBIT $KETRAWPACKETBIT          $KETYPEBROADCAST $KETYPEMULTICAST $KETYPESTANDARD $OPT_SETPROMISCUOUS          $OPT_SETRAWMODE $OPT_RCVDESTADDR $OPT_RCVPACKETTYPE $OPT_DELMCAST          $OPT_ADDMCAST $AF_8022 $KATMSNAPNAME $KATMLANENAME $KT8022NAME          $KATMNAME $KSMDSNAME $KIRTALKNAME $KFDDINAME $KTOKENRINGNAME          $KFASTENETNAME $KENETNAME $KENET8022NAME $KFDDIMODULEID          $KTOKENRINGMODULEID $KENETMODULEID $KT8022MODULEID $LNK_TPI $LNK_FDDI          $LNK_TOKN $LNK_ENET $DL_PROMISC_OFF $KOTRAWRCVONWITHTIMESTAMP          $KOTRAWRCVOFF $KOTRAWRCVON $KOTFRAMING8022 $KOTFRAMING8023          $KOTFRAMINGETHERNETIPX $KOTFRAMINGETHERNET $KOTATMSNAPDEVICE          $KOTATMLANEDEVICE $KOTFDDIDEVICE $KOTFASTETHERNETDEVICE          $KOTMODEMDEVICE $KOTPPPDEVICE $KOTSLIPDEVICE $KOTETHERNETDEVICE          $KOTSERIALDEVICE $KOTSMDSDEVICE $KOTATMDEVICE $KOTISDNDEVICE          $KOTTOKENRINGDEVICE $KOTIRTALKDEVICE $KOTLOCALTALKDEVICE          $KOTMDEVDEVICE $KOTADEVDEVICE))(provide-interface 'opentptlinks)