(in-package :TRAPS);;;;;;;;;;;;;;;;;;;;;;;;;;; Modification History;;;; 03/06/96 bill Map old names to new names;;; Generated from #P"HD:CCL3.0d17:Interface Translator:Source interfaces:Pascal Interfaces:Menus.p"; at Tuesday June 6,1995 2:05:10 pm.; ;  	File:		Menus.p;  ;  	Contains:	Menu Manager Interfaces.;  ;  	Version:	Technology:	System 7.5;  				Package:	Universal Interfaces 2.0 in ÒMPW LatestÓ on ETO #17;  ;  	Copyright:	© 1984-1995 by Apple Computer, Inc.;  				All rights reserved.;  ;  	Bugs?:		If you find a problem with this file, use the Apple Bug Reporter;  				stack.  Include the file and version information (from above);  				in the problem description and send to:;  					Internet:	apple.bugs@applelink.apple.com;  					AppleLink:	APPLE.BUGS;  ; #|                                              ; $IFC UNDEFINED UsingIncludes; $SETC UsingIncludes := 0 |#                                             ; $ENDC#|                                              ; $IFC NOT UsingIncludes |#                                             ; $ENDC; $IFC UNDEFINED __MENUS__; $SETC __MENUS__ := 1; $I+; $SETC MenusIncludes := UsingIncludes; $SETC UsingIncludes := 1#|                                              ; $IFC UNDEFINED __MEMORY__|#(require-interface 'Memory)#|                                              ; $I Memory.p |#                                             ; $ENDC; 	Types.p														; 		ConditionalMacros.p										; 	MixedMode.p													#|                                              ; $IFC UNDEFINED __QUICKDRAW__|#(require-interface 'Quickdraw)#|                                              ; $I Quickdraw.p |#                                             ; $ENDC; 	QuickdrawText.p												; $PUSH; $ALIGN MAC68K; $LibExport+(defconstant $noMark 0)                         ; mark symbol for MarkItem;  menu defProc messages (defconstant $mDrawMsg 0)(defconstant $mChooseMsg 1)(defconstant $mSizeMsg 2)(defconstant $mDrawItemMsg 4)(defconstant $mCalcItemMsg 5)(defconstant $textMenuProc 0)(defconstant $hMenuCmd 27)                      ; itemCmd == 0x001B ==> hierarchical menu(defconstant $hierMenu -1)                      ; a hierarchical menu - for InsertMenu call(defconstant $mPopUpMsg 3)                      ; menu defProc messages - place yourself(defconstant $mctAllItems -98)                  ; search for all Items for the given ID(defconstant $mctLastIDIndic -99)               ; last color table entry has this in ID field; $IFC UNDEFINED STRICT_MENUS ; $SETC STRICT_MENUS := 0; $ENDC#|                                              ; $IFC STRICT_MENUS (def-mactype :menuref (find-mactype ':pointer))(def-mactype :menuhandle (find-mactype ':menuref)) |#                                             ; $ELSEC(defrecord (MenuInfo :handle)    (menuID :signed-integer)   (menuWidth :signed-integer)   (menuHeight :signed-integer)   (menuProc :handle)   (enableFlags :signed-long)   (menuData (:string 255))   )(def-mactype :menuptr (find-mactype '(:pointer :menuinfo)))(def-mactype :menuhandle (find-mactype '(:handle :menuinfo)))(def-mactype :menuref (find-mactype '(:handle :menuinfo))); $ENDC(def-mactype :menudefprocptr (find-mactype ':pointer));  PROCEDURE MenuDef(message: INTEGER; theMenu: MenuRef; VAR menuRect: Rect; hitPt: Point; VAR whichItem: INTEGER); (def-mactype :menubardefprocptr (find-mactype ':pointer));  FUNCTION MenuBarDef(selector: INTEGER; message: INTEGER; parameter1: INTEGER; parameter2: LONGINT): LONGINT; (def-mactype :menuhookprocptr (find-mactype ':pointer));  PROCEDURE MenuHook; (def-mactype :mbarhookprocptr (find-mactype ':pointer));  FUNCTION MBarHook(VAR menuRect: Rect): INTEGER; (def-mactype :menudefupp (find-mactype ':pointer))(def-mactype :menubardefupp (find-mactype ':pointer))(def-mactype :menuhookupp (find-mactype ':pointer))(def-mactype :mbarhookupp (find-mactype ':pointer))(defconstant $uppMenuDefProcInfo #xFF80)        ;  PROCEDURE (2 byte param, 4 byte param, 4 byte param, 4 byte param, 4 byte param); (defconstant $uppMenuBarDefProcInfo #x3AB0)     ;  FUNCTION (2 byte param, 2 byte param, 2 byte param, 4 byte param): 4 byte result; (defconstant $uppMenuHookProcInfo #x0)          ;  PROCEDURE ; (defconstant $uppMBarHookProcInfo #xCF)         ;  SPECIAL_CASE_PROCINFO( kSpecialCaseMBarHook ) ; $IFC NOT GENERATINGCFM ;; Generated by translator basic-stack-trap(deftrap "_NewMenuDefProc" ((userRoutine :pointer))   (:stack :pointer)   (:stack-trap #x2E9F)); $ENDC; $IFC NOT GENERATINGCFM ;; Generated by translator basic-stack-trap(deftrap "_NewMenuBarDefProc" ((userRoutine :pointer))   (:stack :pointer)   (:stack-trap #x2E9F)); $ENDC; $IFC NOT GENERATINGCFM ;; Generated by translator basic-stack-trap(deftrap "_NewMenuHookProc" ((userRoutine :pointer))   (:stack :pointer)   (:stack-trap #x2E9F)); $ENDC; $IFC NOT GENERATINGCFM ;; Generated by translator basic-stack-trap(deftrap "_NewMBarHookProc" ((userRoutine :pointer))   (:stack :pointer)   (:stack-trap #x2E9F)); $ENDC; $IFC NOT GENERATINGCFM;; Inline instructions called as foreign function(deftrap-inline "_CallMenuDefProc" ((message :signed-integer) (theMenu (:handle :menuinfo)) (menuRect (:pointer :rect)) (hitPt :point) (whichItem (:pointer :signed-integer)) (userRoutine :pointer))   nil   (#x205F #x4E90) ); $ENDC; $IFC NOT GENERATINGCFM;; Inline instructions called as foreign function(deftrap-inline "_CallMenuBarDefProc" ((selector :signed-integer) (message :signed-integer) (parameter1 :signed-integer) (parameter2 :signed-long) (userRoutine :pointer))   :signed-long   (#x205F #x4E90) ); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator register-trap-1-arg-no-return(deftrap "_CallMenuHookProc" ((userRoutine :pointer))   nil   (:register-trap #x4E90 :a0 userRoutine)); $ENDC; $IFC NOT GENERATINGCFM                        ; To be implemented:  Glue to move parameters according to special case conventions.; $ENDC;; Warning: No calling method defined for this trap(deftrap-inline "_CallMBarHookProc" ((menuRect (:pointer :rect)) (userRoutine :pointer))   :signed-integer   () )(defrecord MCEntry    (mctID :signed-integer)                      ; menu ID.  ID = 0 is the menu bar   (mctItem :signed-integer)                    ; menu Item. Item = 0 is a title   (mctRGB1 :rgbcolor)                          ; usage depends on ID and Item   (mctRGB2 :rgbcolor)                          ; usage depends on ID and Item   (mctRGB3 :rgbcolor)                          ; usage depends on ID and Item   (mctRGB4 :rgbcolor)                          ; usage depends on ID and Item   (mctReserved :signed-integer)                ; reserved for internal use   )(def-mactype :mcentryptr (find-mactype '(:pointer :mcentry)))(defrecord (MCTable :handle) (array (array :mcentry 1)))(def-mactype :mctableptr (find-mactype '(:pointer :mctable)))(def-mactype :mctablehandle (find-mactype '(:handle :mctable)))(defrecord (MenuCRsrc :handle)    (numEntries :signed-integer)                 ; number of entries   (mcEntryRecs :mctable)                       ; ARRAY [1..numEntries] of MCEntry   )(def-mactype :menucrsrcptr (find-mactype '(:pointer :menucrsrc)))(def-mactype :menucrsrchandle (find-mactype '(:handle :menucrsrc))); $IFC NOT CFMSYSTEMCALLS;; Generated by translator read-word-from-memory(deftrap "_GetMBarHeight" ()   (:no-trap :signed-integer)   (:no-trap (%get-signed-word (%int-to-ptr 2986))));  MOVE.w $0BAA,(SP) ; $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_InitMenus" ()   nil   (:stack-trap #xA930)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_NewMenu" ((menuID :signed-integer) (menuTitle (:string 255)))   (:stack (:handle :menuinfo))   (:stack-trap #xA931)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_GetMenu" ((resourceID :signed-integer))   (:stack (:handle :menuinfo))   (:stack-trap #xA9BF)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_DisposeMenu" ((theMenu (:handle :menuinfo)))   nil   (:stack-trap #xA932)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_AppendMenu" ((menu (:handle :menuinfo)) (data (:string 255)))   nil   (:stack-trap #xA933)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_AppendResMenu" ((theMenu (:handle :menuinfo)) (theType :ostype))   nil   (:stack-trap #xA94D)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_InsertResMenu" ((theMenu (:handle :menuinfo)) (theType :ostype) (afterItem :signed-integer))   nil   (:stack-trap #xA951)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_InsertMenu" ((theMenu (:handle :menuinfo)) (beforeID :signed-integer))   nil   (:stack-trap #xA935)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_DrawMenuBar" ()   nil   (:stack-trap #xA937)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_InvalMenuBar" ()   nil   (:stack-trap #xA81D)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_DeleteMenu" ((menuID :signed-integer))   nil   (:stack-trap #xA936)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_ClearMenuBar" ()   nil   (:stack-trap #xA934)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_GetNewMBar" ((menuBarID :signed-integer))   (:stack :handle)   (:stack-trap #xA9C0)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_GetMenuBar" ()   (:stack :handle)   (:stack-trap #xA93B)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SetMenuBar" ((menuList :handle))   nil   (:stack-trap #xA93C)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_InsertMenuItem" ((theMenu (:handle :menuinfo)) (itemString (:string 255)) (afterItem :signed-integer))   nil   (:stack-trap #xA826)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_DeleteMenuItem" ((theMenu (:handle :menuinfo)) (item :signed-integer))   nil   (:stack-trap #xA952)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_MenuKey" ((ch :character))   (:stack :signed-long)   (:stack-trap #xA93E)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_HiliteMenu" ((menuID :signed-integer))   nil   (:stack-trap #xA938)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SetMenuItemText" ((theMenu (:handle :menuinfo)) (item :signed-integer) (itemString (:string 255)))   nil   (:stack-trap #xA947)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_GetMenuItemText" ((theMenu (:handle :menuinfo)) (item :signed-integer) (itemString (:pointer (:string 255))))   nil   (:stack-trap #xA946)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_DisableItem" ((theMenu (:handle :menuinfo)) (item :signed-integer))   nil   (:stack-trap #xA93A)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_EnableItem" ((theMenu (:handle :menuinfo)) (item :signed-integer))   nil   (:stack-trap #xA939)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_CheckItem" ((theMenu (:handle :menuinfo)) (item :signed-integer) (checked :boolean))   nil   (:stack-trap #xA945)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SetItemMark" ((theMenu (:handle :menuinfo)) (item :signed-integer) (markChar :character))   nil   (:stack-trap #xA944)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_GetItemMark" ((theMenu (:handle :menuinfo)) (item :signed-integer) (markChar (:pointer :character)))   nil   (:stack-trap #xA943)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SetItemIcon" ((theMenu (:handle :menuinfo)) (item :signed-integer) (iconIndex :signed-integer))   nil   (:stack-trap #xA940)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_GetItemIcon" ((theMenu (:handle :menuinfo)) (item :signed-integer) (iconIndex (:pointer :unsigned-byte)))   nil   (:stack-trap #xA93F)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SetItemStyle" ((theMenu (:handle :menuinfo)) (item :signed-integer) (chStyle (:unsigned-byte :set (#:bold #:italic #:underline #:outline shadow #:condense #:extend))))   nil   (:stack-trap #xA942)); $ENDC;; Warning: No calling method defined for this trap(deftrap-inline "_GetItemStyle" ((theMenu (:handle :menuinfo)) (item :signed-integer) (chStyle (:pointer (:unsigned-byte :set (#:bold #:italic #:underline #:outline shadow #:condense #:extend)))))   nil   () )                                         ; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_CalcMenuSize" ((theMenu (:handle :menuinfo)))   nil   (:stack-trap #xA948)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_CountMItems" ((theMenu (:handle :menuinfo)))   (:stack :signed-integer)   (:stack-trap #xA950)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_GetMenuHandle" ((menuID :signed-integer))   (:stack (:handle :menuinfo))   (:stack-trap #xA949)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_FlashMenuBar" ((menuID :signed-integer))   nil   (:stack-trap #xA94C)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SetMenuFlash" ((count :signed-integer))   nil   (:stack-trap #xA94A)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_MenuSelect" ((startPt :point))   (:stack :signed-long)   (:stack-trap #xA93D)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_InitProcMenu" ((resID :signed-integer))   nil   (:stack-trap #xA808)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_GetItemCmd" ((theMenu (:handle :menuinfo)) (item :signed-integer) (cmdChar (:pointer :character)))   nil   (:stack-trap #xA84E)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SetItemCmd" ((theMenu (:handle :menuinfo)) (item :signed-integer) (cmdChar :character))   nil   (:stack-trap #xA84F)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_PopUpMenuSelect" ((menu (:handle :menuinfo)) (top :signed-integer) (left :signed-integer) (popUpItem :signed-integer))   (:stack :signed-long)   (:stack-trap #xA80B)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_MenuChoice" ()   (:stack :signed-long)   (:stack-trap #xAA66)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_DeleteMCEntries" ((menuID :signed-integer) (menuItem :signed-integer))   nil   (:stack-trap #xAA60)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_GetMCInfo" ()   (:stack (:handle :mctable))   (:stack-trap #xAA61)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SetMCInfo" ((menuCTbl (:handle :mctable)))   nil   (:stack-trap #xAA62)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_DisposeMCInfo" ((menuCTbl (:handle :mctable)))   nil   (:stack-trap #xAA63)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_GetMCEntry" ((menuID :signed-integer) (menuItem :signed-integer))   (:stack (:pointer :mcentry))   (:stack-trap #xAA64)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SetMCEntries" ((numEntries :signed-integer) (menuCEntries (:pointer :mctable)))   nil   (:stack-trap #xAA65)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_InsertFontResMenu" ((theMenu (:handle :menuinfo)) (afterItem :signed-integer) (scriptFilter :signed-integer))   nil   (:stack-trap #xA825 :d0 1024 theMenu afterItem scriptFilter)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_InsertIntlResMenu" ((theMenu (:handle :menuinfo)) (theType :ostype) (afterItem :signed-integer) (scriptFilter :signed-integer))   nil   (:stack-trap #xA825 :d0 1537 theMenu theType afterItem scriptFilter)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SystemEdit" ((editCmd :signed-integer))   (:stack :boolean)   (:stack-trap #xA9C2)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap "_SystemMenu" ((menuResult :signed-long))   nil   (:stack-trap #xA9B5)); $ENDC; $IFC OLDROUTINENAMES ; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap ("_AddResMenu" "AppendResMenu")         ((theMenu (:handle :menuinfo)) (theType :ostype))   nil   (:stack-trap #xA94D)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap ("_InsMenuItem" "InsertMenuItem")         ((theMenu (:handle :menuinfo)) (itemString (:string 255)) (afterItem :signed-integer))   nil   (:stack-trap #xA826)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap ("_DelMenuItem" "DeleteMenuItem")         ((theMenu (:handle :menuinfo)) (item :signed-integer))   nil   (:stack-trap #xA952)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap ("_SetItem" "SetMenuItemText")         ((theMenu (:handle :menuinfo)) (item :signed-integer) (itemString (:string 255)))   nil   (:stack-trap #xA947)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap ("_GetItem" "GetMenuItemText")         ((theMenu (:handle :menuinfo)) (item :signed-integer) (itemString (:pointer (:string 255))))   nil   (:stack-trap #xA946)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap ("_GetMHandle" "GetMenuHandle")         ((menuID :signed-integer))   (:stack (:handle :menuinfo))   (:stack-trap #xA949)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap ("_DelMCEntries" "DeleteMCEntries")         ((menuID :signed-integer) (menuItem :signed-integer))   nil   (:stack-trap #xAA60)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator basic-stack-trap(deftrap ("_DispMCInfo" "DisposeMCInfo")         ((menuCTbl (:handle :mctable)))   nil   (:stack-trap #xAA63)); $ENDC; $ENDC; $ALIGN RESET; $POP; $SETC UsingIncludes := MenusIncludes; $ENDC                                         ; __MENUS__#|                                              ; $IFC NOT UsingIncludes |#                                             ; $ENDC(provide-interface 'Menus)