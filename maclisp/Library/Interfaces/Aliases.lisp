(in-package :TRAPS); Generated from #P"HD:CCL3.0d17:Interface Translator:Source interfaces:Pascal Interfaces:Aliases.p"; at Tuesday June 6,1995 2:02:28 pm.; ;  	File:		Aliases.p;  ;  	Contains:	Alias Manager Interfaces.;  ;  	Version:	Technology:	System 7.5;  				Package:	Universal Interfaces 2.0 in “MPW Latest” on ETO #17;  ;  	Copyright:	© 1984-1995 by Apple Computer, Inc.;  				All rights reserved.;  ;  	Bugs?:		If you find a problem with this file, use the Apple Bug Reporter;  				stack.  Include the file and version information (from above);  				in the problem description and send to:;  					Internet:	apple.bugs@applelink.apple.com;  					AppleLink:	APPLE.BUGS;  ; #|                                              ; $IFC UNDEFINED UsingIncludes; $SETC UsingIncludes := 0 |#                                             ; $ENDC#|                                              ; $IFC NOT UsingIncludes |#                                             ; $ENDC; $IFC UNDEFINED __ALIASES__; $SETC __ALIASES__ := 1; $I+; $SETC AliasesIncludes := UsingIncludes; $SETC UsingIncludes := 1#|                                              ; $IFC UNDEFINED __TYPES__|#(require-interface 'Types)#|                                              ; $I Types.p |#                                             ; $ENDC; 	ConditionalMacros.p											#|                                              ; $IFC UNDEFINED __APPLETALK__|#(require-interface 'AppleTalk)#|                                              ; $I AppleTalk.p |#                                             ; $ENDC; 	OSUtils.p													; 		MixedMode.p												; 		Memory.p												#|                                              ; $IFC UNDEFINED __FILES__|#(require-interface 'Files)#|                                              ; $I Files.p |#                                             ; $ENDC; $PUSH; $ALIGN MAC68K; $LibExport+(defconstant $rAliasType :|alis|)               ;  Aliases are stored as resources of this type ;  define alias resolution action rules mask (defconstant $kARMMountVol #x1)                 ;  mount the volume automatically (defconstant $kARMNoUI #x2)                     ;  no user interface allowed during resolution (defconstant $kARMMultVols #x8)                 ;  search on multiple volumes (defconstant $kARMSearch #x100)                 ;  search quickly (defconstant $kARMSearchMore #x200)             ;  search further (defconstant $kARMSearchRelFirst #x400)         ;  search target on a relative path first ;  define alias record information types (defconstant $asiZoneName -3)                   ;  get zone name (defconstant $asiServerName -2)                 ;  get server name (defconstant $asiVolumeName -1)                 ;  get volume name (defconstant $asiAliasName 0)                   ;  get aliased file/folder/volume name (defconstant $asiParentName 1)                  ;  get parent folder name ;  define the alias record that will be the blackbox for the caller (defrecord (AliasRecord :handle)    (userType :ostype)                           ;  appl stored type like creator type    ;;Changing field aliassize from signed-integer to unsigned-word to match C header (pretty-darn-sure)   (aliasSize :unsigned-word)                   ;  alias record size in bytes, for appl usage    )(def-mactype :aliasptr (find-mactype '(:pointer :aliasrecord)))(def-mactype :aliashandle (find-mactype '(:handle :aliasrecord)));  alias record information type (def-mactype :aliasinfotype (find-mactype ':signed-integer))(def-mactype :aliasfilterprocptr (find-mactype ':pointer));  FUNCTION AliasFilter(cpbPtr: CInfoPBPtr; VAR quitFlag: BOOLEAN; myDataPtr: Ptr): BOOLEAN; (def-mactype :aliasfilterupp (find-mactype ':pointer))(defconstant $uppAliasFilterProcInfo #xFD0)     ;  FUNCTION (4 byte param, 4 byte param, 4 byte param): 1 byte result; ; $IFC NOT GENERATINGCFM ;; Generated by translator basic-stack-trap(deftrap "_NewAliasFilterProc" ((userRoutine :pointer))   (:stack :pointer)   (:stack-trap #x2E9F)); $ENDC; $IFC NOT GENERATINGCFM;; Inline instructions called as foreign function(deftrap-inline "_CallAliasFilterProc" ((cpbPtr (:pointer :cinfopbrec)) (quitFlag (:pointer :boolean)) (myDataPtr :pointer) (userRoutine :pointer))   :boolean   (#x205F #x4E90) ); $ENDC; CONST                                         ; $IFC NOT GENERATINGCFM;; Generated by translator moveq-word-to-d0(deftrap "_NewAlias" ((fromFile (:pointer :fsspec)) (target (:pointer :fsspec)) (alias (:pointer (:handle :aliasrecord))))   (:stack :signed-integer)   (:stack-trap #xA823 :d0 2 fromFile target alias)); $ENDC;  create a minimal new alias for a target and return alias record handle ; CONST                                         ; $IFC NOT GENERATINGCFM;; Generated by translator moveq-word-to-d0(deftrap "_NewAliasMinimal" ((target (:pointer :fsspec)) (alias (:pointer (:handle :aliasrecord))))   (:stack :signed-integer)   (:stack-trap #xA823 :d0 8 target alias)); $ENDC;  create a minimal new alias from a target fullpath (optional zone and server name) and return alias record handle  ; $IFC NOT GENERATINGCFM;; Generated by translator moveq-word-to-d0(deftrap "_NewAliasMinimalFromFullPath" ((fullPathLength :signed-integer) (fullPath :pointer) (zoneName (:string 32)) (serverName (:string 31)) (alias (:pointer (:handle :aliasrecord))))   (:stack :signed-integer)   (:stack-trap #xA823 :d0 9 fullPathLength fullPath zoneName serverName alias)); $ENDC;  given an alias handle and fromFile, resolve the alias, update the alias record and return aliased filename and wasChanged flag. ; $IFC NOT GENERATINGCFM;; Generated by translator moveq-word-to-d0(deftrap "_ResolveAlias" ((fromFile (:pointer :fsspec)) (alias (:handle :aliasrecord)) (target (:pointer :fsspec)) (wasChanged (:pointer :boolean)))   (:stack :signed-integer)   (:stack-trap #xA823 :d0 3 fromFile alias target wasChanged)); $ENDC;  given an alias handle and an index specifying requested alias information type, return the information from alias record as a string. ; $IFC NOT GENERATINGCFM;; Generated by translator moveq-word-to-d0(deftrap "_GetAliasInfo" ((alias (:handle :aliasrecord)) (index :signed-integer) (theString (:pointer (:string 63))))   (:stack :signed-integer)   (:stack-trap #xA823 :d0 7 alias index theString)); $ENDC;  ;   Given a file spec, return target file spec if input file spec is an alias.;   It resolves the entire alias chain or one step of the chain.  It returns;   info about whether the target is a folder or file; and whether the input;   file spec was an alias or not. ; ; $IFC NOT GENERATINGCFM;; Generated by translator moveq-word-to-d0(deftrap "_ResolveAliasFile" ((theSpec (:pointer :fsspec)) (resolveAliasChains :boolean) (targetIsFolder (:pointer :boolean)) (wasAliased (:pointer :boolean)))   (:stack :signed-integer)   (:stack-trap #xA823 :d0 12 theSpec resolveAliasChains targetIsFolder wasAliased)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator moveq-word-to-d0(deftrap "_FollowFinderAlias" ((fromFile (:pointer :fsspec)) (alias (:handle :aliasrecord)) (logon :boolean) (target (:pointer :fsspec)) (wasChanged (:pointer :boolean)))   (:stack :signed-integer)   (:stack-trap #xA823 :d0 15 fromFile alias logon target wasChanged)); $ENDC;  ;    Low Level Routines ;  Given an alias handle and fromFile, match the alias and return aliased filename(s) and needsUpdate flag; ; $IFC NOT GENERATINGCFM;; Generated by translator moveq-word-to-d0(deftrap "_MatchAlias" ((fromFile (:pointer :fsspec)) (rulesMask :signed-long) (alias (:handle :aliasrecord)) (aliasCount (:pointer :signed-integer)) (aliasList (:pointer :fsspec)) (needsUpdate (:pointer :boolean)) (aliasFilter :pointer) (yourDataPtr :pointer))   (:stack :signed-integer)   (:stack-trap #xA823 :d0 5 fromFile rulesMask alias aliasCount aliasList needsUpdate aliasFilter yourDataPtr)); $ENDC;  given a fromFile-target pair and an alias handle, update the lias record pointed to by alias handle to represent target as the new alias. ; CONST                                         ; $IFC NOT GENERATINGCFM;; Generated by translator moveq-word-to-d0(deftrap "_UpdateAlias" ((fromFile (:pointer :fsspec)) (target (:pointer :fsspec)) (alias (:handle :aliasrecord)) (wasChanged (:pointer :boolean)))   (:stack :signed-integer)   (:stack-trap #xA823 :d0 6 fromFile target alias wasChanged)); $ENDC; $ALIGN RESET; $POP; $SETC UsingIncludes := AliasesIncludes; $ENDC                                         ; __ALIASES__#|                                              ; $IFC NOT UsingIncludes |#                                             ; $ENDC(provide-interface 'Aliases)