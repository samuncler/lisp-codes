(in-package :TRAPS); Generated from #P"HD:CCL3.0d17:Interface Translator:Source interfaces:Pascal Interfaces:Editions.p"; at Tuesday June 6,1995 2:08:29 pm.; ;  	File:		Editions.p;  ;  	Contains:	Edition Manager Interfaces.;  ;  	Version:	Technology:	System 7.5;  				Package:	Universal Interfaces 2.0 in “MPW Latest” on ETO #17;  ;  	Copyright:	© 1984-1995 by Apple Computer, Inc.;  				All rights reserved.;  ;  	Bugs?:		If you find a problem with this file, use the Apple Bug Reporter;  				stack.  Include the file and version information (from above);  				in the problem description and send to:;  					Internet:	apple.bugs@applelink.apple.com;  					AppleLink:	APPLE.BUGS;  ; #|                                              ; $IFC UNDEFINED UsingIncludes; $SETC UsingIncludes := 0 |#                                             ; $ENDC; $IFC NOT UsingIncludes; $ENDC; $IFC UNDEFINED __EDITIONS__; $SETC __EDITIONS__ := 1; $I+; $SETC EditionsIncludes := UsingIncludes; $SETC UsingIncludes := 1#|                                              ; $IFC UNDEFINED __MEMORY__|#(require-interface 'Memory)#|                                              ; $I Memory.p |#                                             ; $ENDC; 	Types.p														; 		ConditionalMacros.p										; 	MixedMode.p													#|                                              ; $IFC UNDEFINED __TYPES__|#(require-interface 'Types)#|                                              ; $I Types.p |#                                             ; $ENDC#|                                              ; $IFC UNDEFINED __FILES__|#(require-interface 'Files)#|                                              ; $I Files.p |#                                             ; $ENDC; 	OSUtils.p													#|                                              ; $IFC UNDEFINED __ALIASES__|#(require-interface 'Aliases)#|                                              ; $I Aliases.p |#                                             ; $ENDC; 	AppleTalk.p													#|                                              ; $IFC UNDEFINED __DIALOGS__|#(require-interface 'Dialogs)#|                                              ; $I Dialogs.p |#                                             ; $ENDC; 	Errors.p													; 	Windows.p													; 		Quickdraw.p												; 			QuickdrawText.p										; 		Events.p												; 		Controls.p												; 			Menus.p												; 	TextEdit.p													; $PUSH; $ALIGN MAC68K; $LibExport+;  resource types  (defconstant $rSectionType :|sect|)             ;  ResType of saved SectionRecords ;  Finder types for edition files (defconstant $kPICTEditionFileType :|edtp|)(defconstant $kTEXTEditionFileType :|edtt|)(defconstant $ksndEditionFileType :|edts|)(defconstant $kUnknownEditionFileType :|edtu|)(defconstant $kPublisherDocAliasFormat :|alis|)(defconstant $kPreviewFormat :|prvw|)(defconstant $kFormatListFormat :|fmts|);  section types (defconstant $stSubscriber #x1)(defconstant $stPublisher #xA)(defconstant $sumAutomatic 0)                   ;  subscriber update mode - Automatically     (defconstant $sumManual 1)                      ;  subscriber update mode - Manually (defconstant $pumOnSave 0)                      ;  publisher update mode - OnSave            (defconstant $pumManual 1)                      ;  publisher update mode - Manually (defconstant $kPartsNotUsed 0)(defconstant $kPartNumberUnknown -1)            ;  misc (defconstant $kPreviewWidth 120)(defconstant $kPreviewHeight 120);  bits for formatsMask (defconstant $kPICTformatMask 1)(defconstant $kTEXTformatMask 2)(defconstant $ksndFormatMask 4);  pseudo-item hits for dialogHooks ;  the first if for NewPublisher or NewSubscriber Dialogs (defconstant $emHookRedrawPreview 150);  the following are for SectionOptions Dialog (defconstant $emHookCancelSection 160)(defconstant $emHookGoToPublisher 161)(defconstant $emHookGetEditionNow 162)(defconstant $emHookSendEditionNow 162)(defconstant $emHookManualUpdateMode 163)(defconstant $emHookAutoUpdateMode 164);  the refcon field of the dialog record during a modalfilter ;  or dialoghook contains one the following (defconstant $emOptionsDialogRefCon :|optn|)(defconstant $emCancelSectionDialogRefCon :|cncl|)(defconstant $emGoToPubErrDialogRefCon :|gerr|)(defconstant $kFormatLengthUnknown -1);  one byte, stSubscriber or stPublisher (def-mactype :sectiontype (find-mactype ':signed-byte));  seconds since 1904 (def-mactype :timestamp (find-mactype ':signed-long));  similar to ResType (def-mactype :formattype (find-mactype ':ostype));  used in Edition I/O (def-mactype :editionrefnum (find-mactype ':handle));  update modes ;  sumAutomatic, pumSuspend, etc (def-mactype :updatemode (find-mactype ':signed-integer))(def-mactype :sectionptr (find-mactype '(:pointer :sectionrecord)))(def-mactype :sectionhandle (find-mactype '(:handle :sectionrecord)))(defrecord (SectionRecord :handle)    (version :signed-byte)                       ;  always 0x01 in system 7.0    (kind :signed-byte)                          ;  stSubscriber or stPublisher    (mode :signed-integer)                       ;  auto or manual    (mdDate :signed-long)                        ;  last change in document    (sectionID :signed-long)                     ;  app. specific, unique per document    (refCon :signed-long)                        ;  application specific    (alias (:handle :aliasrecord))               ;  handle to Alias Record    (subPart :signed-long)                       ;  which part of container file    (nextSection (:handle :sectionrecord))       ;  for linked list of app's Sections    (controlBlock :handle)                       ;  used internally    (refNum :handle)                             ;  used internally    )(defrecord EditionContainerSpec    (theFile :fsspec)   (theFileScript :signed-integer)   (thePart :signed-long)   (thePartName (:string 31))   (thePartScript :signed-integer)   )(def-mactype :editioncontainerspecptr (find-mactype '(:pointer :editioncontainerspec)))(defrecord EditionInfoRecord    (crDate :signed-long)                        ;  date EditionContainer was created    (mdDate :signed-long)                        ;  date of last change    (fdCreator :ostype)                          ;  file creator    (fdType :ostype)                             ;  file type    (container :editioncontainerspec)            ;  the Edition    )(defrecord NewPublisherReply    (canceled :boolean)                          ;  O    (replacing :boolean)   (usePart :boolean)                           ;  I    (filler :signed-byte)   (preview :handle)                            ;  I    (previewFormat :ostype)                      ;  I    (container :editioncontainerspec)            ;  I/O    )(defrecord NewSubscriberReply    (canceled :boolean)                          ;  O    (formatsMask :signed-byte)   (container :editioncontainerspec)            ; I/O   )(defrecord SectionOptionsReply    (canceled :boolean)                          ;  O    (changed :boolean)                           ;  O    (sectionH (:handle :sectionrecord))          ;  I    (action :ostype)                             ;  O    )(def-mactype :expmodalfilterprocptr (find-mactype ':pointer));  FUNCTION ExpModalFilter(theDialog: DialogPtr; VAR theEvent: EventRecord; itemOffset: INTEGER; VAR itemHit: INTEGER; yourDataPtr: Ptr): BOOLEAN; (def-mactype :expdlghookprocptr (find-mactype ':pointer));  FUNCTION ExpDlgHook(itemOffset: INTEGER; itemHit: INTEGER; theDialog: DialogPtr; yourDataPtr: Ptr): INTEGER; (def-mactype :expmodalfilterupp (find-mactype ':pointer))(def-mactype :expdlghookupp (find-mactype ':pointer))(defconstant $uppExpModalFilterProcInfo #xFBD0) ;  FUNCTION (4 byte param, 4 byte param, 2 byte param, 4 byte param, 4 byte param): 1 byte result; (defconstant $uppExpDlgHookProcInfo #x3EA0)     ;  FUNCTION (2 byte param, 2 byte param, 4 byte param, 4 byte param): 2 byte result; ; $IFC NOT GENERATINGCFM ;; Generated by translator basic-stack-trap(deftrap "_NewExpModalFilterProc" ((userRoutine :pointer))   (:stack :pointer)   (:stack-trap #x2E9F)); $ENDC; $IFC NOT GENERATINGCFM ;; Generated by translator basic-stack-trap(deftrap "_NewExpDlgHookProc" ((userRoutine :pointer))   (:stack :pointer)   (:stack-trap #x2E9F)); $ENDC; $IFC NOT GENERATINGCFM;; Inline instructions called as foreign function(deftrap-inline "_CallExpModalFilterProc" ((theDialog (:pointer :grafport)) (theEvent (:pointer :eventrecord)) (itemOffset :signed-integer) (itemHit (:pointer :signed-integer)) (yourDataPtr :pointer) (userRoutine :pointer))   :boolean   (#x205F #x4E90) ); $ENDC; $IFC NOT GENERATINGCFM;; Inline instructions called as foreign function(deftrap-inline "_CallExpDlgHookProc" ((itemOffset :signed-integer) (itemHit :signed-integer) (theDialog (:pointer :grafport)) (yourDataPtr :pointer) (userRoutine :pointer))   :signed-integer   (#x205F #x4E90) ); $ENDC(defconstant $ioHasFormat 0)(defconstant $ioReadFormat 1)(defconstant $ioNewFormat 2)(defconstant $ioWriteFormat 3)(def-mactype :formatioverb (find-mactype ':signed-byte))(defconstant $eoOpen 0)(defconstant $eoClose 1)(defconstant $eoOpenNew 2)(defconstant $eoCloseNew 3)(defconstant $eoCanSubscribe 4)(def-mactype :editionopenerverb (find-mactype ':signed-byte))(defrecord FormatIOParamBlock    (ioRefNum :signed-long)   (format :ostype)   (formatIndex :signed-long)   ;;Changing field offset from signed-long to unsigned-long to match C header (pretty-sure)   (offset :unsigned-long)   (buffPtr :pointer)   ;;Changing field bufflen from signed-long to unsigned-long to match C header (pretty-darn-sure)   (buffLen :unsigned-long)   )(def-mactype :formatioprocptr (find-mactype ':pointer));  FUNCTION FormatIO(selector: ByteParameter; VAR PB: FormatIOParamBlock): INTEGER; (def-mactype :editionopenerprocptr (find-mactype ':pointer));  FUNCTION EditionOpener(selector: ByteParameter; VAR PB: EditionOpenerParamBlock): INTEGER; (def-mactype :formatioupp (find-mactype ':pointer))(def-mactype :editionopenerupp (find-mactype ':pointer))(defrecord EditionOpenerParamBlock    (info :editioninforecord)   (sectionH (:handle :sectionrecord))   (document (:pointer :fsspec))   (fdCreator :ostype)   (ioRefNum :signed-long)   (ioProc :pointer)   (success :boolean)   (formatsMask :signed-byte)   )(defconstant $uppFormatIOProcInfo #x360)        ;  FUNCTION (1 byte param, 4 byte param): 2 byte result; (defconstant $uppEditionOpenerProcInfo #x360)   ;  FUNCTION (1 byte param, 4 byte param): 2 byte result; ; $IFC NOT GENERATINGCFM ;; Generated by translator basic-stack-trap(deftrap "_NewFormatIOProc" ((userRoutine :pointer))   (:stack :pointer)   (:stack-trap #x2E9F)); $ENDC; $IFC NOT GENERATINGCFM ;; Generated by translator basic-stack-trap(deftrap "_NewEditionOpenerProc" ((userRoutine :pointer))   (:stack :pointer)   (:stack-trap #x2E9F)); $ENDC(defconstant $sectionEventMsgClass :|sect|)(defconstant $sectionReadMsgID :|read|)(defconstant $sectionWriteMsgID :|writ|)(defconstant $sectionScrollMsgID :|scrl|)(defconstant $sectionCancelMsgID :|cncl|)(defconstant $currentEditionMgrVers #x11);  Use InitEditionPackVersion(currentEditionMgrVers) instead of InitEditionPack ; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_InitEditionPackVersion" ((curEditionMgrVers :signed-integer))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 256 curEditionMgrVers)); $ENDC; CONST                                         ; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_NewSection" ((container (:pointer :editioncontainerspec)) (sectionDocument (:pointer :fsspec)) (kind :signed-byte) (sectionID :signed-long) (initalMode :signed-integer) (sectionH (:pointer (:handle :sectionrecord))))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 2562 container sectionDocument kind sectionID initalMode sectionH)); $ENDC; CONST                                         ; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_RegisterSection" ((sectionDocument (:pointer :fsspec)) (sectionH (:handle :sectionrecord)) (aliasWasUpdated (:pointer :boolean)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 1540 sectionDocument sectionH aliasWasUpdated)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_UnRegisterSection" ((sectionH (:handle :sectionrecord)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 518 sectionH)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_IsRegisteredSection" ((sectionH (:handle :sectionrecord)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 520 sectionH)); $ENDC; CONST                                         ; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_AssociateSection" ((sectionH (:handle :sectionrecord)) (newSectionDocument (:pointer :fsspec)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 1036 sectionH newSectionDocument)); $ENDC; CONST                                         ; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_CreateEditionContainerFile" ((editionFile (:pointer :fsspec)) (fdCreator :ostype) (editionFileNameScript :signed-integer))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 1294 editionFile fdCreator editionFileNameScript)); $ENDC; CONST                                         ; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_DeleteEditionContainerFile" ((editionFile (:pointer :fsspec)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 528 editionFile)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_OpenEdition" ((subscriberSectionH (:handle :sectionrecord)) (refNum (:pointer :handle)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 1042 subscriberSectionH refNum)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_OpenNewEdition" ((publisherSectionH (:handle :sectionrecord)) (fdCreator :ostype) (publisherSectionDocument (:pointer :fsspec)) (refNum (:pointer :handle)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 2068 publisherSectionH fdCreator publisherSectionDocument refNum)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_CloseEdition" ((whichEdition :handle) (successful :boolean))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 790 whichEdition successful)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_EditionHasFormat" ((whichEdition :handle) (whichFormat :ostype) (formatSize (:pointer :signed-long)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 1560 whichEdition whichFormat formatSize)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_ReadEdition" ((whichEdition :handle) (whichFormat :ostype) (buffPtr :pointer) (buffLen (:pointer :signed-long)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 2074 whichEdition whichFormat buffPtr buffLen)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_WriteEdition" ((whichEdition :handle) (whichFormat :ostype) (buffPtr :pointer) (buffLen :signed-long))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 2076 whichEdition whichFormat buffPtr buffLen)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_GetEditionFormatMark" ((whichEdition :handle) (whichFormat :ostype) (currentMark (:pointer :signed-long)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 1566 whichEdition whichFormat currentMark)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_SetEditionFormatMark" ((whichEdition :handle) (whichFormat :ostype) (setMarkTo :signed-long))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 1568 whichEdition whichFormat setMarkTo)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_GetEditionInfo" ((sectionH (:handle :sectionrecord)) (editionInfo (:pointer :editioninforecord)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 1058 sectionH editionInfo)); $ENDC; CONST                                         ; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_GoToPublisherSection" ((container (:pointer :editioncontainerspec)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 548 container)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_GetLastEditionContainerUsed" ((container (:pointer :editioncontainerspec)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 550 container)); $ENDC; CONST                                         ; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_GetStandardFormats" ((container (:pointer :editioncontainerspec)) (previewFormat (:pointer :ostype)) (preview :handle) (publisherAlias :handle) (formats :handle))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 2600 container previewFormat preview publisherAlias formats)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_GetEditionOpenerProc" ((opener (:pointer :pointer)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 554 opener)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_SetEditionOpenerProc" ((opener :pointer))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 556 opener)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_CallEditionOpenerProc" ((selector :signed-byte) (PB (:pointer :editionopenerparamblock)) (routine :pointer))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 1326 selector PB routine)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_CallFormatIOProc" ((selector :signed-byte) (PB (:pointer :formatioparamblock)) (routine :pointer))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 1328 selector PB routine)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_NewSubscriberDialog" ((reply (:pointer :newsubscriberreply)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 562 reply)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_NewSubscriberExpDialog" ((reply (:pointer :newsubscriberreply)) (where :point) (expansionDITLresID :signed-integer) (dlgHook :pointer) (filter :pointer) (yourDataPtr :pointer))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 2868 reply where expansionDITLresID dlgHook filter yourDataPtr)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_NewPublisherDialog" ((reply (:pointer :newpublisherreply)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 566 reply)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_NewPublisherExpDialog" ((reply (:pointer :newpublisherreply)) (where :point) (expansionDITLresID :signed-integer) (dlgHook :pointer) (filter :pointer) (yourDataPtr :pointer))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 2872 reply where expansionDITLresID dlgHook filter yourDataPtr)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_SectionOptionsDialog" ((reply (:pointer :sectionoptionsreply)))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 570 reply)); $ENDC; $IFC NOT GENERATINGCFM;; Generated by translator put-a-constant-word-in-d0(deftrap "_SectionOptionsExpDialog" ((reply (:pointer :sectionoptionsreply)) (where :point) (expansionDITLresID :signed-integer) (dlgHook :pointer) (filter :pointer) (yourDataPtr :pointer))   (:stack :signed-integer)   (:stack-trap #xA82D :d0 2876 reply where expansionDITLresID dlgHook filter yourDataPtr)); $ENDC; $ALIGN RESET; $POP; $SETC UsingIncludes := EditionsIncludes; $ENDC                                         ; __EDITIONS__; $IFC NOT UsingIncludes; $ENDC(provide-interface 'Editions);; This form has been added from patch file HD:CCL3.0d17:Interface Translator:legacies:Editions.patch(DEFTRAP "_INITEDITIONPACK"         NIL         (:STACK :SIGNED-INTEGER)         (:STACK-TRAP 43053 (17 :SIGNED-INTEGER) :D0 256))