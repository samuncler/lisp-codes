(in-package :oou)(oou-provide :menubar-hide);*****************************************************************                                    ;; Copyright © 1991 Institut fuer Informatik, University of Basel, Switzerland ; All Rights Reserved;; Author: Lynch;; send events when mcl is suspended / resumed; ;; Changes (worth to be mentioned):; ------------------------------; none ;;*****************************************************************;*****************************************************************(defparameter *menubar-hidden-p* nil  "Maintained by menubar-hide and menubar-show.")(defvar *menubar-height* (#_GetMBarHeight)  "The height of the menubar.")(defun set-menubar-height (int)  "intSets the height of the menubar to int."  (%put-word (%int-to-ptr #x0BAA) int))(defun menubar-hide ()  "Hides the menubar and sets *menubar-hidden-p* to t.Destructively modifies the system handle GrayRgn."  (setq *menubar-hidden-p* t)  (let* ((menubar-region (#_NewRgn))         (gray-region (%get-ptr (%int-to-ptr #$GrayRgn)))         (front (front-window))         (win-ptr (when front (wptr front)))        )    (set-menubar-height 0)    (#_SetRectRgn menubar-region 0 0 *screen-width* *menubar-height*)    (#_UnionRgn menubar-region gray-region gray-region)    (when win-ptr      (#_PaintOne win-ptr menubar-region)      (#_PaintBehind win-ptr menubar-region)      (#_CalcVis win-ptr)      (#_CalcVisBehind win-ptr menubar-region)    )    (#_DisposHandle menubar-region)) )(defun menubar-show ()  "Shows the menubar and sets *menubar-hidden-p* to nil.Destructively modifies (restores) the system handle GrayRgn."  (setq *menubar-hidden-p* nil)  (let* ((menubar-region (#_NewRgn))         (gray-region (%get-ptr (%int-to-ptr #$GrayRgn)))         (front (front-window))         (win-ptr (when front (wptr front)))        )    (set-menubar-height *menubar-height*)    (#_SetRectRgn menubar-region 0 0 *screen-width* *menubar-height*)    (#_DiffRgn gray-region menubar-region gray-region)    (when win-ptr      (#_CalcVis win-ptr)      (#_CalcVisBehind win-ptr menubar-region)    )    (#_HiliteMenu 0)    (#_DrawMenuBar)    (#_DisposHandle menubar-region)) )(defun menubar-suspend ()  "Calls menubar-show in response to suspend-event-handler."  (when *menubar-hidden-p*    (menubar-show)    (setq *menubar-hidden-p* t)) )(defun menubar-resume ()  "Calls menubar-hide in response to suspend-event-handler."  (when *menubar-hidden-p*    (menubar-hide)) )#|(push #'menubar-suspend oou::*suspend-functions*)(push #'menubar-resume oou::*resume-functions*)(menubar-hide);(menubar-show)|#