(in-package :oou)(oou-provide :GoMan-No-Source-Icon);*****************************************************************                                    ;; Copyright © 1991 Institut fuer Informatik, University of Basel, Switzerland ; All Rights Reserved;; Author: Dieter Holz;; to get no Source Icon in  GoMan's destination window; ;; Changes (worth to be mentioned):; ------------------------------; none ;;*****************************************************************;*****************************************************************(export '());--------------------------------------------------------------------------(defmethod make-menu-bar ((self destination-window))   (let* ((copy-icon               (make-instance 'destination-window-icon-di                   :view-size #@(26 21)                   :view-position #@(0 0)                   :rsrc-file "oou:resources stuff"                   :rsrc-id 154   ;copy                   :draw-outline t                   :PICT-scaling :center-in-view                   :docu-line-string "Copy the selection"                   :dialog-item-action #'(lambda (icon)                                                         (copy (real-fred (fred-window (view-window icon)))))))             (search-icon                (make-instance 'destination-window-icon-di                   :view-size #@(26 21)                   :view-position #@(27 0)                   :rsrc-file "oou:resources stuff"                   :rsrc-id 161 ;search                   :draw-outline t                   :PICT-scaling :center-in-view                   :docu-line-string "Search a string in the text"                   :dialog-item-action #'(lambda (icon)                                                         (let ((window (view-window icon)))                                                            (invert-icon-of-dialog-item-on-screen window)                                                            (if (search-dialog-item window)                                                               (show-dialog-item window (search-dialog-item window))                                                               (make-search-dialog-item window))))))             (one-step-back-icon               (make-instance 'destination-window-icon-di                   :view-size #@(26 21)                   :view-position (make-point (- (window-width  (document self)) 37) 0)                   :rsrc-file "oou:resources stuff"                   :rsrc-id 156                   :draw-outline t                   :dialog-item-enabled-p nil                   :PICT-scaling :center-in-view                   :docu-line-string "Go back to the text position before the last jump"                   :dialog-item-action #'(lambda (icon)                                                         (let ((window (view-window icon)))                                                            (jump-to-last-position window)))))             (polaroid-icon               (make-instance 'destination-window-icon-di                   :view-size #@(26 21)                   :view-position (make-point (- (window-width  (document self)) 10) 0)                   :rsrc-file "oou:resources stuff"                   :rsrc-id 152                   :draw-outline t                   :PICT-scaling :center-in-view                   :docu-line-string "Take a picture of the current text position and put it in the archive"                   :dialog-item-action  #'(lambda (icon)                                                          (let ((window (view-window icon)))                                                             (invert-icon-of-dialog-item-on-screen window)                                                             (let ((bookmark-dialog-item (bookmark-dialog-item window)))                                                                (if bookmark-dialog-item                                                                   (show-dialog-item window bookmark-dialog-item)                                                                   (progn                                                                       (make-bookmark-dialog-item window)                                                                      (view-draw-contents window)))                                                                (generate-bookmark window)))))))      (setf (back-arrow self) one-step-back-icon)      (setf (copy-icon self) copy-icon)      (make-instance 'unibas-paned-view          :view-size (make-point (+ (window-width  (document self)) 16) 21)          :view-position #@(1 1)          :subview-description (list (list copy-icon                                                             :constant                                                            :stick-on-topleft)                                                    (list search-icon                                                             :constant                                                            :stick-on-topleft)                                    (list one-step-back-icon                                                            :constant                                                            :stick-on-topleft)                                                    (list one-step-back-icon                                                            :constant                                                            :stick-on-topright)                                                    (list polaroid-icon                                                            :constant                                                            :stick-on-topright)))))