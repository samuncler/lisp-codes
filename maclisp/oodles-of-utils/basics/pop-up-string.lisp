(in-package :oou)(oou-provide :pop-up-string);*****************************************************************                                    ;; Copyright © 1993 Institut fuer Informatik, University of Basel, Switzerland ; All Rights Reserved;; Author: Dieter Holz;; pop up a string while the mouse is down. No view is used. It is drawn directly on the screen; ;; Changes (worth to be mentioned):; ------------------------------; none ;;*****************************************************************;*****************************************************************(oou-dependencies :wmgr-view                  :Quickdraw-u                  :GDevice-u                  :screen-safer)(export '(pop-up-string));---------------------------------------------------------------------------(defun pop-up-string (string &optional (font '("Monaco" 9 :plain)) (position (view-mouse-position nil)))  (multiple-value-bind (ascent descent maxwidth leading) (font-info font)    (declare (ignore maxwidth))    (rlet ((rect :rect                 :top (- (point-v position) ascent)                 :left (- (point-h position) 3)                 :bottom (+ (point-v position) descent leading 2)                 :right (+ (point-h position) (string-width string font) 2)))      (with-saved-screen-map (*Wmgr-View* rect)         (with-focused-view *Wmgr-View*          (multiple-value-bind (old-ff old-ms) (grafport-font-codes)            (multiple-value-bind (ff ms) (font-codes font)              (set-grafport-font-codes ff ms))            (#_MoveTo :long position)            (#_EraseRect rect)            (princ string  *Wmgr-View*)            (#_FrameRect rect)            (loop              (unless (mouse-down-p)                (return)))            (set-grafport-font-codes old-ff old-ms)))))))#|(defclass my-window (window)  ())(defmethod view-click-event-handler ((self my-window) where)  (declare (ignore where))  (pop-up-string "Hello World"))(make-instance 'my-window)|#