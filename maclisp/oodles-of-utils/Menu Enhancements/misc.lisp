(in-package :oou);;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; oou-utils.lisp;;;; Copyright © 1992 University of Toronto, Department of Computer Science;; All Rights Reserved;;;; author: Mark A. Tapia markt@dgp.utoronto.ca or markt@dgp.toronto.edu;;;;  Part of this code is from the oodles-of-utils package;;  with modifications for the traps to work under MCL2.0f2;;  and with support for color quickkdraw added.;; Change history;;  1992-05-13 added support for color window manager and macros for;;             saving a rectangular portion of the screen bit/pixmap,;;                executing any number of forms and then restoring the rectangular;;             bit/pixmap.;; ;;  1992-05-22 compatability features added for MCL2.0f...;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(export '(queued-modal-dialog));---------------------------------------------------------------------------(defun queued-modal-dialog (window &optional (close-on-return t))  "Similar to modal-dialog, but supports eval-enqueue actions"  (unwind-protect    (catch-cancel       (loop        while (and (WINDOW-SHOWN-P window) (wptr window))        do (event-dispatch)        (when *eval-queue*          (loop            while *eval-queue*            do (eval (pop *eval-queue*))))))    (when (and (wptr window) close-on-return)      (window-close window))))