; -*- Mode: Lisp; Package: CCL; -*-(in-package :ccl);; wrap body in progn so no complaints re multiple tags(let ((*warn-if-redefine* nil)      (*warn-if-redefine-kernel* nil))(defmacro dolist ((varsym list &optional ret) &body body &environment env)  (if (not (symbolp varsym)) (signal-program-error $XNotSym varsym))  (let* ((toplab (gensym))         (tstlab (gensym))         (lstsym (gensym)))    (multiple-value-bind (forms decls) (parse-body body env nil)     `(let* ((,lstsym ,list) ,varsym)        ,@decls        (block nil          (tagbody            (go ,tstlab)            ,toplab            (setq ,lstsym (cdr (the list ,lstsym)))            ,(cons 'progn forms)  ;; was ,@forms            ,tstlab            (setq ,varsym (car ,lstsym))            (if ,lstsym (go ,toplab)))          ,@(if ret `((progn  ,ret)))))))))