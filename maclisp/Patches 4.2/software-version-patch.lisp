; -*- Mode: Lisp; Package: CCL; -*-(in-package :ccl)(let ((*warn-if-redefine* nil)      (*warn-if-redefine-kernel* nil));; from David Lamkins(defun software-type ()  (let* ((macsh (#_GetResource :|MACS| 0))         (macss (or (and (not (%null-ptr-p macsh)) (%get-string macsh))                    "Unknown"))         (len (or                (search "version" macss :test #'string-equal)               (position #\Space macss)               (position #\Newline macss)               (length macss))))    (string-trim ", " (%substr macss 0 len))))(defun software-version ()  (%str-cat "Rom Version "            (%integer-to-string (gestalt "romv") 16)            ", System Version "            (let ((sysv (gestalt "sysv")))              (%str-cat (%integer-to-string (ldb (byte 4 8) sysv))                        "."                        (%integer-to-string (ldb (byte 4 4) sysv))                        "."                        (%integer-to-string (ldb (byte 4 0) sysv)))))))