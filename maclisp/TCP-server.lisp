(defun start-daemon ()  (ccl::init-opentransport)  (process-run-function '(:name "OZONE Daemon" :background-p t)                                          #'run-daemon-server)  (ccl::opentransport-cleanup))                           (defun run-daemon-server ()  (loop     (let* ((host nil)           (port 1025)           (stream (ccl::open-tcp-stream  host port)))      (format t "~% IN RUN DAEMON SERVER STREAM = ~A" stream)           (format t "~% STATE OF CONNECTION ~A" (ccl::opentransport-stream-connection-state stream))          (process-wait "Waiting for connection"                    #'(lambda()                         (eq :dataxfer                            (ccl::opentransport-stream-connection-state stream))))          (process-run-function '(:name "connection handler" :background-p t)                                        #'connection-handler stream))))                           (defun connection-handler (stream)    (format t "~% CONNECTION ESTABLISHED STREAM ~A" stream)     (loop with        token = nil         while t        do (process-wait             "Waiting for input"            #'(lambda()                 (or                  (eq :closed                     (ccl::opentransport-stream-connection-state stream))                                 (listen stream))))        do (format t "~% STATE OF CONNECTION ~A ~A" stream                                              (ccl::opentransport-stream-connection-state stream))                    if (listen stream)        do (loop while (listen stream)                 do (format t "~% ~A" (setf token (ccl::telnet-read-line                                                                       stream))))        and do  (format t "~% TOKEN ~A ~A" token (string= token "quit"))                  and if (string= token "quit")        do (close stream)        if  (eq :closed (ccl::opentransport-stream-connection-state stream))            do (format t "~% CLOSING STREAM")        and do (return)))                                                     #|                          (start-daemon)Da usare con "java Client rucola 1025" che si trova in carota sotto java/sockets                          |#